<!DOCTYPE html>
<html>
    <head>
        <title>Idle Spiral Info Repo</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\(','\)']]}});</script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script>
          var currentExplanation = "";
          $(document).ready(function() { 
            $(".explainable").each(function() {
              $(this).click(function() {
                var name = "";
                var classes = $(this).attr('class').split(' ');
                for ( var i = 0; i < classes.length; i++ ) {
                  if ( classes[i].indexOf('explain_') == 0 ) {
                    name = classes[i].substring(8);
                    break;
                  }
                }
                if ( name == "" ) {
                  console.log("No explaination found for " + $(this));
                  return;
                }

                if ( currentExplanation != "") {
                  console.log("Hiding " + currentExplanation);
                  $(currentExplanation).hide();
                }
                var target = "#explanation_" + name;
                console.log("Showing " + target);
                $(target).show();
                currentExplanation = target;
              });
            });
          }); 

          class Effect {
            constructor ( name, target, type, formula, value ) {
              this.name = name;
              this.target = target;
              this.type = type;
              this.formula = formula;
              this.value = value;
            }
          }
          var idlespiral = new function IdleSpiral ( ) {

            // Save file
            this.loadSave = function ( save ) {
              save = save.split("#");

              this.saver = JSON.parse(this.decrypt(save[0]));
              this.save = JSON.parse(this.decrypt(save[1]));
              this.dto = JSON.parse(this.decrypt(save[2]));
              console.log(this.dto);

              this.battle_rewards = {
                "hp": this.dto.battle_rewards[0],
                "atk": this.dto.battle_rewards[1],
                "def": this.dto.battle_rewards[2],
                "a": this.dto.battle_rewards[3],
                "b": this.dto.battle_rewards[4],
                "c": this.dto.battle_rewards[5],
                "d": this.dto.battle_rewards[6],
                "e": this.dto.battle_rewards[7],
                "k": this.dto.battle_rewards[8],
                "regene": this.dto.battle_rewards[9],
                "critical": this.dto.battle_rewards[10],
                "criticalDamage": this.dto.battle_rewards[11],
                "a_mul": this.dto.battle_rewards[12],
                "b_mul": this.dto.battle_rewards[13],
                "c_mul": this.dto.battle_rewards[14],
                "d_mul": this.dto.battle_rewards[15],
                "e_mul": this.dto.battle_rewards[16],
                "k_mul": this.dto.battle_rewards[17],
                "hp_mul": this.dto.battle_rewards[18],
                "atk_mul": this.dto.battle_rewards[19],
                "def_mul": this.dto.battle_rewards[20],
                "n": this.dto.battle_rewards[21],
                "v": this.dto.battle_rewards[22],
                "gamma": this.dto.battle_rewards[23],
                "delta": this.dto.battle_rewards[24],
                "Omega": this.dto.battle_rewards[25],
                "attackSpeed": this.dto.battle_rewards[26],
                "gamma_mul": this.dto.battle_rewards[27],
                "delta_mul": this.dto.battle_rewards[28],
                "Omega_mul": this.dto.battle_rewards[29],
                "exp": this.dto.battle_rewards[30],
                "rare_chance": this.dto.battle_rewards[31],
                "super_critical": this.dto.battle_rewards[32],
                "super_criticalDamage": this.dto.battle_rewards[33],
                "math_skill": this.dto.battle_rewards[34],
                "other": this.dto.battle_rewards[35],
                "enemy_hp_reduction": this.dto.battle_rewards[36],
                "regene_resting": this.dto.battle_rewards[37],
                "maxlevelup_no_24": this.dto.battle_rewards[38],
                "unlock": this.dto.battle_rewards[39],
              }
              this.battle_upgrades = {
                "hp+1%": this.dto.battle_upgrade_levels[0],
                "atk+1%": this.dto.battle_upgrade_levels[1],
                "def+1%": this.dto.battle_upgrade_levels[2],
                "regene+1%": this.dto.battle_upgrade_levels[3],
                "reward_hp+1": this.dto.battle_upgrade_levels[4],
                "reward_atk+1": this.dto.battle_upgrade_levels[5],
                "reward_def+1": this.dto.battle_upgrade_levels[6],
                "critical+0.1%": this.dto.battle_upgrade_levels[7],
                "criticalDamage+1%": this.dto.battle_upgrade_levels[8],
                "reward_exp+1": this.dto.battle_upgrade_levels[9],
                "enemy_hp-0.1%" : this.dto.battle_upgrade_levels[10],
                "regene_while_resting+1%": this.dto.battle_upgrade_levels[11],
                "attack_speed+0.1%": this.dto.battle_upgrade_levels[12],
                "hp+5%": this.dto.battle_upgrade_levels[13],
                "atk+5%": this.dto.battle_upgrade_levels[14],
                "def+5%": this.dto.battle_upgrade_levels[15],
                "regene+5%": this.dto.battle_upgrade_levels[16],
                "reward_hp+5%": this.dto.battle_upgrade_levels[17],
                "reward_atk+5%": this.dto.battle_upgrade_levels[18],
                "reward_def+5%": this.dto.battle_upgrade_levels[19],
                "reward_exp+5%": this.dto.battle_upgrade_levels[20],
                "critical+0.2%": this.dto.battle_upgrade_levels[21],
                "criticalDamage+5%": this.dto.battle_upgrade_levels[22],
                "attack_speed+0.5%": this.dto.battle_upgrade_levels[23],
                "battle_upgrade_max_level+1": this.dto.battle_upgrade_levels[24],
                "unlock_1" : this.dto.battle_upgrade_levels[25],
                "unlock_2" : this.dto.battle_upgrade_levels[26],
                "unlock_3" : this.dto.battle_upgrade_levels[27],
                "unlock_4" : this.dto.battle_upgrade_levels[28],
                "atk_and_def_from_pi+1": this.dto.battle_upgrade_levels[29],
                "exp_from_gamma+1": this.dto.battle_upgrade_levels[30],
                "s_critical_from_napier+1": this.dto.battle_upgrade_levels[31],
                "math_skill+100": this.dto.battle_upgrade_levels[32],
                "hp+10%": this.dto.battle_upgrade_levels[33],
                "atk+10%": this.dto.battle_upgrade_levels[34],
                "def+10%": this.dto.battle_upgrade_levels[35],
                "reward_hp+10%": this.dto.battle_upgrade_levels[36],
                "reward_atk+10%": this.dto.battle_upgrade_levels[37],
                "reward_def+10%": this.dto.battle_upgrade_levels[38],
                "reward_exp+10%": this.dto.battle_upgrade_levels[39],
                "rare_chance+0.1%": this.dto.battle_upgrade_levels[40],
                "battle_upgrade_max_level_2+1": this.dto.battle_upgrade_levels[41],
              };
              this.lines = 1;
              this.omegaPrestigeLevel = this.dto.softResetNum;
              this.reactor_levels = {
                "r": this.dto.reactor_levels[0],
                "lineRenderer": this.dto.reactor_levels[1],
                "equation": this.dto.reactor_levels[2],
                "battle_stats": this.dto.reactor_levels[3],
                "crit": this.dto.reactor_levels[4],
                "s_crit": this.dto.reactor_levels[5],
              };
              this.reactor_values = {
                "r": this.dto.reactor_values[0],
                "lineRenderer": this.dto.reactor_values[1],
                "equation": this.dto.reactor_values[2],
                "battle_stats": this.dto.reactor_values[3],
                "crit": this.dto.reactor_values[4],
                "s_crit": this.dto.reactor_values[5],
              };
              this.upgradeLevels = {
                "a": this.dto.upgradeLevels[0],
                "b": this.dto.upgradeLevels[1],
                "c": this.dto.upgradeLevels[2],
                "d": this.dto.upgradeLevels[3],
                "e": this.dto.upgradeLevels[4],
                "f": this.dto.upgradeLevels[5],
                "g": this.dto.upgradeLevels[6],
                "ae11": this.dto.upgradeLevels[7],
                "logk": this.dto.upgradeLevels[8],
                "beMul": this.dto.upgradeLevels[9],
                "k": this.dto.upgradeLevels[10],
                "parmA": this.dto.upgradeLevels[11],
                "parmB": this.dto.upgradeLevels[12],
                "parmC": this.dto.upgradeLevels[13],
                "parmD": this.dto.upgradeLevels[14],
                "parmE": this.dto.upgradeLevels[15],
                "parmF": this.dto.upgradeLevels[16],
                "parmG": this.dto.upgradeLevels[17],
                "parmK": this.dto.upgradeLevels[18],
                "prestigepoint_denominator": this.dto.upgradeLevels[19],
                "exponentK": this.dto.upgradeLevels[20],
                "u": this.dto.upgradeLevels[21],
                "v": this.dto.upgradeLevels[22],
                "n": this.dto.upgradeLevels[23],
                "Omega": this.dto.upgradeLevels[24],
                "gamma": this.dto.upgradeLevels[25],
                "delta": this.dto.upgradeLevels[26],
                "z_multiplier": this.dto.upgradeLevels[27],
                "a_mul": this.dto.upgradeLevels[28],
                "b_mul": this.dto.upgradeLevels[29],
                "c_mul": this.dto.upgradeLevels[30],
                "d_mul": this.dto.upgradeLevels[31],
                "e_mul": this.dto.upgradeLevels[32],
                "f_mul": this.dto.upgradeLevels[33],
                "g_mul": this.dto.upgradeLevels[34],
                "rAll": this.dto.upgradeLevels[35],
                "m": this.dto.upgradeLevels[36],
                "alpha": this.dto.upgradeLevels[37],
                "beta": this.dto.upgradeLevels[38],
              };
              this.variableUpgradeLevels = {
                "k": this.dto.variableUpgradeLevels[0],
                "a": this.dto.variableUpgradeLevels[1],
                "b": this.dto.variableUpgradeLevels[2],
                "c": this.dto.variableUpgradeLevels[3],
                "d": this.dto.variableUpgradeLevels[4],
                "e": this.dto.variableUpgradeLevels[5],
                "f": this.dto.variableUpgradeLevels[6],
                "g": this.dto.variableUpgradeLevels[7],
                "atk": this.dto.variableUpgradeLevels[8],
                "def": this.dto.variableUpgradeLevels[9],
              };
              this.z = this.dto.z;
            }
            this.decrypt = function ( text ) {
              this.kdf = CryptoJS.PBKDF2("kkyyhka", "stkttnsstkttns", {
                keySize: 8,
                hasher: CryptoJS.algo.SHA1,
                iterations: 1000
              });
              
              this.key = CryptoJS.enc.Hex.parse(this.kdf.toString().substring(0, 32));
              this.iv = CryptoJS.enc.Hex.parse(this.kdf.toString().substring(32, 64));

              return CryptoJS.AES.decrypt({ciphertext: CryptoJS.enc.Base64.parse(text)}, this.key, { iv: this.iv }).toString(CryptoJS.enc.Utf8);
            }

            // Rendering
            this.updateFunctions = [];
            this.addUpdateFunction = function ( func ) {
              this.updateFunctions.push(func);
            }
            this.update = function ( ) {
              $('.update_display').each(function() {
                var classes = $(this).attr('class').split(' ');
                for ( var i = 0; i < classes.length; i++ ) {
                  if ( classes[i].indexOf('display_') == 0 ) {
                    var name = classes[i].substring(8);
                    $(this).text(idlespiral.evaluate(name));
                    break;
                  }
                  if ( classes[i].indexOf('battle_reward_') == 0 ) {
                    var name = classes[i].substring(14);
                    $(this).text(idlespiral.battle_rewards[name]);
                    break;
                  }
                }
              });

              for (var func of this.updateFunctions)
                func(this);
            }
            
            // Effects
            this.effects = {};
            this.addEffect = function ( name, target, type, formula, value ) {
              if ( this.effects[name] )
                throw "Effect already exists: " + name;
              this.effects[name] = new Effect(name, target, type, formula, value);
            }
            this.addBaseValue = function ( name, value ) {
              this.addEffect("Init " + name, name, "base", value, () => value);
            }
            this.getEffects = function ( name, prefix = "" ) {
              var effects = {
                "base": [],
                "add": [],
                "mul": [],
                "indep": [],
                "exp": [],
              };

              for ( var effect in this.effects )
                if ( this.effects[effect].target == name && this.effects[effect].name.indexOf(prefix) == 0 )
                  effects[this.effects[effect].type].push(this.effects[effect]);
              
              return effects;
            }
            this.cache = {};
            this.evaluate = function ( name ) {
              if ( this.cache[name] )
                return this.cache[name];
              
              var effects = this.getEffects(name);

              var value = 0;
              if ( effects["base"].length > 1 )
                throw "Multiple base effects for " + name;
              if ( effects["base"].length == 1 )
                value = effects["base"][0].value();
              for ( var effect of effects["add"] )
                value += effect.value();
              for ( var effect of effects["mul"] )
                value *= effect.value();
              for ( var effect of effects["indep"] )
                value += effect.value();
              for ( var effect of effects["exp"] )
                value **= effect.value();
              
              this.cache[name] = value;
              return value;
            }
            
            this.init = function ( ) {
              // Parameter
              this.addBaseValue("a", 1);
              this.addBaseValue("b", 1);
              this.addBaseValue("c", 1);
              this.addBaseValue("d", 1);
              this.addBaseValue("e", 1);
              this.addBaseValue("f", 1);
              this.addBaseValue("g", 1);
              this.addBaseValue("u", 1);
              this.addBaseValue("n", 1);
              this.addBaseValue("m", 1);
              this.addBaseValue("omegaExponent", 1);
              this.addBaseValue("gamma", 0.1);
              this.addBaseValue("alpha", 1);
              this.addBaseValue("beta", 1);
              this.addBaseValue("cubit_root", 3);
              this.addBaseValue("logarithm_base", 100);
              this.addBaseValue("prestigePoint_denominator", 1e5);
              this.addBaseValue("tornado_cost_reduction", 1);
              this.addBaseValue("automation_interval", 1);

              this.addBaseValue("atk", 10);
              this.addBaseValue("hp", 100);
              this.addBaseValue("def", 1);
              this.addBaseValue("deltap", 1);
              this.addBaseValue("regene_while_resting", 1);
              this.addBaseValue("critical", 0.05);
              this.addBaseValue("criticalDamage", 2);
              this.addBaseValue("attack_speed", 1);
              this.addBaseValue("enemy_hp_reduction_add", 100);
              this.addBaseValue("reward_atk_mul", 1);
              this.addBaseValue("reward_def_mul", 1);
              this.addBaseValue("reward_hp_mul", 1);
              this.addBaseValue("reward_exp_mul", 1);
              this.addBaseValue("rare_drop", 1);
              this.addBaseValue("super_critical_damage", 5);
              this.addBaseValue("battle_upgrade_cost", 1);
              this.addBaseValue("enemy_growth_reduction", 1);
              
              this.addBaseValue("line_number_multiplier", 1);
              this.addBaseValue("equation_speed", 1);
              this.addBaseValue("z_reactor_exp", 1);
              this.addBaseValue("z_reactor_cap", 1);
              this.addBaseValue("spiralPointFromTornadoPrestige", 1);

              // Currency / ReccurenceMultiplier
              this.addEffect("Formula integral", "integral", "base", "$\frac{2\alpha^{\beta+1}}{\beta+1}$", () => {
                var alpha = this.evaluate("alpha");
                var beta = this.evaluate("beta");
                var integral = 2 * alpha ** (beta + 1) / (beta + 1);
                return integral;
              });
              this.addEffect("Base sigmaA", "sigmaA", "base", "$\displaystyle\sum\limits_{l=1}^n A_l$", () => {
                var u = this.evaluate("u");
                var v = this.evaluate("v");
                var n = this.evaluate("n");
                var A = this.evaluate("largeA");
                var integral = this.evaluate("integral");

                if ( n == 1 )
                  return A;
                  
                var Ai = A;
                var sum = Ai;
                for ( var i = 1; i < n; i++ ) {
                  Ai = integral * u * Ai + v;
                  sum += Ai;
                }

                return sum;
              });

              // Currency / DistanceMultiplier
              this.addEffect("Base largeA", "largeA", "base", "$a \times b \times c \times d \times e \times f \times g$", () => {
                var a = this.evaluate("a");
                var b = this.evaluate("b");
                var c = this.evaluate("c");
                var d = this.evaluate("d");
                var e = this.evaluate("e");
                var f = this.evaluate("f");
                var g = this.evaluate("g");
                if ( this.currentChallengeKind == ChallengeKind.poorMath )
                  return a + b + c + d + e + f + g;
                else
                  return a * b * c * d * e * f * g;
              });

              this.addEffect("Base delta_r", "delta_r", "base", "$m sigmaA \omega^{omegaExponent}$", () => {
                var m = this.evaluate("m");
                var sigmaA = this.evaluate("sigmaA");
                var omega = this.evaluate("omega");
                var omegaExponent = this.evaluate("omegaExponent");
                var k = this.evaluate("k");
                return m * sigmaA * omega ** omegaExponent + k;
              });
              
              this.addEffect("Line Number Multiplier", "delta_r", "mul", "1 + (lines - 1) * line_number_multiplier", () => 1 + (this.lines - 1) * this.evaluate("line_number_multiplier"));
            
              // SoftPrestige
              this.addEffect("omega Prestige omegaExponent", "omegaExponent", "add", "\omega prestige", () => this.omegaPrestigeLevel);
              this.addEffect("Base omega", "omega", "base", "1.25^{\omega prestige}", () => 1.25 ** this.omegaPrestigeLevel);
              
              // UpgradeContainer
              this.addEffect("r upgrade k", "k", "add", "level", () => this.upgradeLevels["k"]);
              this.addEffect("r upgrade a", "a", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["a"]);
              this.addEffect("r upgrade b", "b", "add", "0.01 * level", () => 0.01 * this.upgradeLevels["b"]);
              this.addEffect("r upgrade c", "c", "add", "0.01 * level", () => 0.01 * this.upgradeLevels["c"]);
              this.addEffect("r upgrade d", "d", "add", "0.01 * level", () => 0.01 * this.upgradeLevels["d"]);
              this.addEffect("r upgrade e", "e", "add", "0.01 * level", () => 0.01 * this.upgradeLevels["e"]);
              this.addEffect("r upgrade ae11 a", "a", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.upgradeLevels["ae11"]);
              this.addEffect("r upgrade ae11 b", "b", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.upgradeLevels["ae11"]);
              this.addEffect("r upgrade ae11 c", "c", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.upgradeLevels["ae11"]);
              this.addEffect("r upgrade ae11 d", "d", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.upgradeLevels["ae11"]);
              this.addEffect("r upgrade ae11 e", "e", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.upgradeLevels["ae11"]);
              this.addEffect("r upgrade logk", "a", "mul", "1 + 0.1 * level * log_10(k + 1)", () => 1 + 0.1 * this.upgradeLevels["logk"] * Math.log10(this.evaluate("k") + 1));
              this.addEffect("r upgrade f", "f", "add", "level", () => 0.01 * this.upgradeLevels["f"]);
              this.addEffect("r upgrade g", "g", "add", "level", () => 0.01 * this.upgradeLevels["g"]);
              this.addEffect("r upgrade beMul passive", "a", "mul", "$\frac{b+c+d+e+f+g}{6}$", () => (this.evaluate("b") + this.evaluate("c") + this.evaluate("d") + this.evaluate("e") + this.evaluate("f") + this.evaluate("g")) / 6.0);
              this.addEffect("r upgrade beMul active", "a", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["beMul"]);
              this.addEffect("r upgrade rAll passive", "delta_r", "mul", "rAll passive", () => 1 + (this.upgradeLevels["k"] + this.upgradeLevels["a"] + this.upgradeLevels["b"] + this.upgradeLevels["c"] + this.upgradeLevels["d"] + this.upgradeLevels["e"] + this.upgradeLevels["ae11"] + this.upgradeLevels["logk"] + this.upgradeLevels["f"] + this.upgradeLevels["g"] + this.upgradeLevels["beMul"] + this.upgradeLevels["rAll"]) / 10000);
              this.addEffect("r upgrade rAll active", "delta_r", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["rAll"]);

              this.addEffect("p upgrade n", "n", "add", "level", () => this.upgradeLevels["n"]);
              this.addEffect("p upgrade v", "v", "add", "10 * level", () => 10 * this.upgradeLevels["v"]);
              this.addEffect("p upgrade u", "u", "add", "level", () => this.upgradeLevels["u"]);
              this.addEffect("p upgrade parmA", "a", "add", "level", () => this.upgradeLevels["parmA"]);
              this.addEffect("p upgrade parmK", "k", "add", "10 * level", () => 10 * this.upgradeLevels["parmK"]);
              this.addEffect("p upgrade parmB", "b", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["parmB"]);
              this.addEffect("p upgrade parmC", "c", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["parmC"]);
              this.addEffect("p upgrade parmD", "d", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["parmD"]);
              this.addEffect("p upgrade parmE", "e", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["parmE"]);
              this.addEffect("p upgrade parmF", "f", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["parmF"]);
              this.addEffect("p upgrade parmG", "g", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["parmG"]);
              this.addEffect("p upgrade prestigePoint_demoninator", "prestigePoint_demoninator", "mul", "0.95 ** level", () => 0.95 ** this.upgradeLevels["prestigepoint_denominator"]);
              this.addEffect("p upgrade exponentK", "k", "exp", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["exponentK"]);
              this.addEffect("p upgrade alpha", "alpha", "add", "0.01 * level", () => 0.01 * this.upgradeLevels["alpha"]);
              this.addEffect("p upgrade beta", "beta", "add", "0.01 * level", () => 0.01 * this.upgradeLevels["beta"]);

              this.addEffect("z upgrade z_multiplier", "delta_r", "mul", "1 + (((level > 0) ? 1 : 0) + 0.1 * level) * log10(z + 1) / 5", () => 1 + (((this.upgradeLevels["z_multiplier"] > 0) ? 1 : 0) + 0.1 * this.upgradeLevels["z_multiplier"]) * Math.log10(this.z + 1) / 5);
              this.addEffect("z upgrade Omega", "Omega", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["Omega"]);
              this.addEffect("z upgrade gamma", "gamma", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["gamma"]);
              this.addEffect("z upgrade delta", "delta", "add", "0.1 * level", () => 0.1 * this.upgradeLevels["delta"]);
              this.addEffect("z upgrade a_mul", "a", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["a_mul"]);
              this.addEffect("z upgrade b_mul", "b", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["b_mul"]);
              this.addEffect("z upgrade c_mul", "c", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["c_mul"]);
              this.addEffect("z upgrade d_mul", "d", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["d_mul"]);
              this.addEffect("z upgrade e_mul", "e", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["e_mul"]);
              this.addEffect("z upgrade f_mul", "f", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["f_mul"]);
              this.addEffect("z upgrade g_mul", "g", "mul", "1 + 0.1 * level", () => 1 + 0.1 * this.upgradeLevels["g_mul"]);
              this.addEffect("z upgrade m", "m", "add", "level", () => this.upgradeLevels["m"]);
              
              // Currency / ZMultiplier
              this.addEffect("Omega unlock", "Omega", "add", "0.1 if tornadoPrestigeTier >= 1", () => this.dto.tornadoPrestigeTier >= 1 ? 0.1 : 0);
              this.addEffect("Base delta_z", "delta_z", "base", "$\gamma$ * $\Omega$ + $\delta$", () => this.evaluate("gamma") * this.evaluate("Omega") + this.evaluate("delta"));

              // Prestige / TornadoPrestige
              this.addEffect("Tornado bonus delta r tier factor", "delta_r", "mul", "1 + 0.5 * tornadoPrestigeTier", () => 1 + 0.5 * this.dto.tornadoPrestigeTier);
              this.addEffect("Tornado bonus delta r playtime factor", "delta_r", "mul", "1 + HourFactor(AccumulatedHour)", () => 1 + HourFactor(this.dto.AccumulatedHour));
              this.addEffect("Tornado bonus delta r max P factor", "delta_r", "mul", "1 + 0.1 * log10(AccumulatedMaxP + 1)", () => 1 + 0.1 * Math.log10(this.dto.AccumulatedMaxP + 1));

              this.addEffect("Tornado bonus delta z tier factor", "delta_z", "mul", "1 + 0.5 * tornadoPrestigeTier", () => 1 + 0.5 * this.dto.tornadoPrestigeTier);
              this.addEffect("Tornado bonus delta z playtime factor", "delta_z", "mul", "1 + HourFactor(AccumulatedHour)", () => 1 + HourFactor(this.dto.AccumulatedHour));
              this.addEffect("Tornado bonus delta z max P factor", "delta_z", "mul", "1 + 0.1 * log10(AccumulatedMaxP + 1)", () => 1 + 0.1 * Math.log10(this.dto.AccumulatedMaxP + 1));

              this.addEffect("Tornado bonus regene_while_resting tier factor", "regene_while_resting", "mul", "1 + 0.1 * tornadoPrestigeTier", () => 1 + 0.1 * this.dto.tornadoPrestigeTier);
              this.addEffect("Tornado bonus regene_while_resting playtime factor", "regene_while_resting", "mul", "1 + HourFactor(AccumulatedHour)", () => 1 + HourFactor(this.dto.AccumulatedHour));
              this.addEffect("Tornado bonus regene_while_resting max P factor", "regene_while_resting", "mul", "1 + 0.1 * log10(AccumulatedMaxP + 1)", () => 1 + 0.1 * Math.log10(this.dto.AccumulatedMaxP + 1));

              this.addEffect("Tornado bonus a", "a", "add", "tornado_a", () => 0.2 * this.dto.tornadoPrestigeTier * HourFactor(this.dto.AccumulatedHour) * (1 + 0.1 * Math.log10(this.dto.AccumulatedMaxP + 1)));
              this.addEffect("Tornado bonus b", "b", "add", "tornado_b", () => 0.02 * this.dto.tornadoPrestigeTier * HourFactor(this.dto.AccumulatedHour) * (1 + 0.01 * Math.log10(this.dto.AccumulatedMaxP + 1)));
              this.addEffect("Tornado bonus c", "c", "add", "tornado_c", () => 0.02 * this.dto.tornadoPrestigeTier * HourFactor(this.dto.AccumulatedHour) * (1 + 0.01 * Math.log10(this.dto.AccumulatedMaxP + 1)));
              this.addEffect("Tornado bonus d", "d", "add", "tornado_d", () => 0.02 * this.dto.tornadoPrestigeTier * HourFactor(this.dto.AccumulatedHour) * (1 + 0.01 * Math.log10(this.dto.AccumulatedMaxP + 1)));
              this.addEffect("Tornado bonus e", "e", "add", "tornado_e", () => 0.02 * this.dto.tornadoPrestigeTier * HourFactor(this.dto.AccumulatedHour) * (1 + 0.01 * Math.log10(this.dto.AccumulatedMaxP + 1)));

              this.addEffect("Tornado unlock NewSigma", "m", "add", "1 if tornadoPrestigeTier >= 13", () => this.dto.tornadoPrestigeTier >= 13 ? 1 : 0);
              this.addEffect("Tornado unlock critical", "critical", "indep", "0.1 if tornadoPrestigeTier >= 17", () => this.dto.tornadoPrestigeTier >= 17 ? 0.1 : 0);
              this.addEffect("Tornado unlock criticalDamage", "criticalDamage", "mul", "2 if tornadoPrestigeTier >= 17", () => this.dto.tornadoPrestigeTier >= 17 ? 2 : 0);
              
              // InfiniteSpiralDomain
              this.addEffect("Store upgrade k", "k", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["k"]);
              this.addEffect("Store upgrade a", "a", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["a"]);
              this.addEffect("Store upgrade b", "b", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["b"]);
              this.addEffect("Store upgrade c", "c", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["c"]);
              this.addEffect("Store upgrade d", "d", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["d"]);
              this.addEffect("Store upgrade e", "e", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["e"]);
              this.addEffect("Store upgrade f", "f", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["f"]);
              this.addEffect("Store upgrade g", "g", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["g"]);
              this.addEffect("Store upgrade atk", "atk", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["atk"]);
              this.addEffect("Store upgrade def", "def", "mul", "1 + 0.01 * level", () => 1 + 0.01 * this.variableUpgradeLevels["def"]);
              
              // BattleReward / BattleRewardContainer
              this.addEffect("Battle reward a", "a", "add", "battle reward a", () => this.battle_rewards["a"]);
              this.addEffect("Battle reward b", "b", "add", "battle reward b", () => this.battle_rewards["b"]);
              this.addEffect("Battle reward c", "c", "add", "battle reward c", () => this.battle_rewards["c"]);
              this.addEffect("Battle reward d", "d", "add", "battle reward d", () => this.battle_rewards["d"]);
              this.addEffect("Battle reward e", "e", "add", "battle reward e", () => this.battle_rewards["e"]);
              this.addEffect("Battle reward k", "k", "add", "battle reward k", () => this.battle_rewards["k"]);
              
              this.addEffect("Battle reward atk", "atk", "add", "battle reward atk", () => this.battle_rewards["atk"]);
              this.addEffect("Battle reward def", "def", "add", "battle reward def", () => this.battle_rewards["def"]);
              this.addEffect("Battle reward hp", "hp", "add", "battle reward hp", () => this.battle_rewards["hp"]);
              this.addEffect("Battle reward regene", "regene", "add", "battle reward regene", () => this.battle_rewards["regene"]);
              this.addEffect("Battle reward critical", "critical", "add", "battle reward critical", () => this.battle_rewards["critical"]);
              this.addEffect("Battle reward criticalDamage", "criticalDamage", "mul", "1 + battle reward criticalDamage", () => 1 + this.battle_rewards["criticalDamage"]);

              this.addEffect("Battle reward gamma", "gamma", "add", "battle reward gamma", () => this.battle_rewards["gamma"]);
              this.addEffect("Battle reward delta", "delta", "add", "battle reward delta", () => this.battle_rewards["delta"]);
              this.addEffect("Battle reward Omega", "Omega", "add", "battle reward Omega", () => this.battle_rewards["Omega"]);

              this.addEffect("Battle reward super_critical", "super_critical", "add", "battle reward super_critical", () => this.battle_rewards["super_critical"]);
              this.addEffect("Battle reward super_critical_damage", "super_critical_damage", "mul", "1 + battle reward super_criticalDamage", () => 1 + this.battle_rewards["super_criticalDamage"]);
              this.addEffect("Battle reward super_critical threshold", "super_critical", "add", "0.01 if battle reward super_criticalDamage > 5", () => this.battle_rewards["super_criticalDamage"] > 5 ? 0.01 : 0);

              this.addEffect("Battle reward a%", "a", "mul", "1 + battle reward a%", () => 1 + this.battle_rewards["a_mul"]);
              this.addEffect("Battle reward b%", "b", "mul", "1 + battle reward b%", () => 1 + this.battle_rewards["b_mul"]);
              this.addEffect("Battle reward c%", "c", "mul", "1 + battle reward c%", () => 1 + this.battle_rewards["c_mul"]);
              this.addEffect("Battle reward d%", "d", "mul", "1 + battle reward d%", () => 1 + this.battle_rewards["d_mul"]);
              this.addEffect("Battle reward e%", "e", "mul", "1 + battle reward e%", () => 1 + this.battle_rewards["e_mul"]);
              this.addEffect("Battle reward k%", "k", "mul", "1 + battle reward k%", () => 1 + this.battle_rewards["k_mul"]);

              this.addEffect("Battle reward hp%", "hp", "mul", "1 + battle reward hp%", () => 1 + this.battle_rewards["hp_mul"]);
              this.addEffect("Battle reward atk%", "atk", "mul", "1 + battle reward atk%", () => 1 + this.battle_rewards["atk_mul"]);
              this.addEffect("Battle reward def%", "def", "mul", "1 + battle reward def%", () => 1 + this.battle_rewards["def_mul"]);

              this.addEffect("Battle reward gamma%", "gamma", "mul", "1 + battle reward gamma%", () => 1 + this.battle_rewards["gamma_mul"]);
              this.addEffect("Battle reward delta%", "delta", "mul", "1 + battle reward delta%", () => 1 + this.battle_rewards["delta_mul"]);
              this.addEffect("Battle reward Omega%", "Omega", "mul", "1 + battle reward Omega%", () => 1 + this.battle_rewards["Omega_mul"]);

              this.addEffect("Battle reward attack speed", "attack_speed", "mul", "battle reward attack speed", () => diminishedAttackSpeed(this.battle_rewards["attackSpeed"]));
              this.addEffect("Battle reward rare drop", "rare_drop", "mul", "battle reward rare chance", () => diminishedRareChance(this.battle_rewards["rare_chance"]));
              this.addEffect("Battle reward math", "math_skill", "add", "battle reward math", () => this.battle_rewards["math_skill"]);
              this.addEffect("Battle reward enemy growth reduction", "enemy_growth_reduction", "mul", "battle reward enemy growth reduction", () => decay(this.battle_rewards["math_skill"]));

              // BattleUpgrades
              this.addEffect("Battle upgrade HP +1%", "hp", "mul", "1 + battle upgrade HP +1%", () => 1 + 0.01 * this.battle_upgrades["hp+1%"]);
              this.addEffect("Battle upgrade ATK +1%", "atk", "mul", "1 + battle upgrade ATK +1%", () => 1 + 0.01 * this.battle_upgrades["atk+1%"]);
              this.addEffect("Battle upgrade DEF +1%", "def", "mul", "1 + battle upgrade DEF +1%", () => 1 + 0.01 * this.battle_upgrades["def+1%"]);
              this.addEffect("Battle upgrade Regenerate +1%", "regene", "mul", "1 + battle upgrade Regenerate +1%", () => 1 + 0.01 * this.battle_upgrades["regene+1%"]);
              this.addEffect("Battle upgrade Reward HP +1", "reward_hp", "add", "1 + battle upgrade Reward HP +1", () => this.battle_upgrades["reward_hp+1"]);
              this.addEffect("Battle upgrade Reward ATK +1", "reward_atk", "add", "1 + battle upgrade Reward ATK +1", () => this.battle_upgrades["reward_atk+1"]);
              this.addEffect("Battle upgrade Reward DEF +1", "reward_def", "add", "1 + battle upgrade Reward DEF +1", () => this.battle_upgrades["reward_def+1"]);
              this.addEffect("Battle upgrade Critical +0.1%", "critical", "indep", "1 + battle upgrade Critical +1%", () => 0.001 * this.battle_upgrades["critical+0.1%"]);
              this.addEffect("Battle upgrade Critical Damage +1%", "criticalDamage", "mul", "1 + battle upgrade Critical Damage +1%", () => 1 + 0.01 * this.battle_upgrades["criticalDamage+1%"]);
              this.addEffect("Battle upgrade Reward EXP +1", "reward_exp", "add", "1 + battle upgrade Reward EXP +1", () => this.battle_upgrades["reward_exp+1"]);
              this.addEffect("Battle upgrade Enemy HP Reduction +1%", "enemy_hp_reduction_add", "add", "1 + battle upgrade Enemy HP Reduction +1%", () => -0.1 * this.battle_upgrades["enemy_hp-0.1%"]);
              this.addEffect("Battle upgrade Regenerate While Resting +1%", "regene_while_resting", "mul", "1 + battle upgrade Regenerate While Resting +1%", () => 1 + 0.01 * this.battle_upgrades["regene_while_resting+1%"]);
              this.addEffect("Battle upgrade Attack Speed +0.1%", "attack_speed", "mul", "1 + battle upgrade Attack Speed +1%", () => 1 + 0.001 * this.battle_upgrades["attack_speed+0.1%"]);
              this.addEffect("Battle upgrade HP +5%", "hp", "mul", "1 + battle upgrade HP +5%", () => 1 + 0.05 * this.battle_upgrades["hp+5%"]);
              this.addEffect("Battle upgrade ATK +5%", "atk", "mul", "1 + battle upgrade ATK +5%", () => 1 + 0.05 * this.battle_upgrades["atk+5%"]);
              this.addEffect("Battle upgrade DEF +5%", "def", "mul", "1 + battle upgrade DEF +5%", () => 1 + 0.05 * this.battle_upgrades["def+5%"]);
              this.addEffect("Battle upgrade Regenerate +5%", "regene", "mul", "1 + battle upgrade Regenerate +5%", () => 1 + 0.05 * this.battle_upgrades["regene+5%"]);
              this.addEffect("Battle upgrade Reward HP +5%", "reward_hp", "mul", "1 + battle upgrade Reward HP +5%", () => 1 + 0.05 * this.battle_upgrades["reward_hp+5%"]);
              this.addEffect("Battle upgrade Reward ATK +5%", "reward_atk", "mul", "1 + battle upgrade Reward ATK +5%", () => 1 + 0.05 * this.battle_upgrades["reward_atk+5%"]);
              this.addEffect("Battle upgrade Reward DEF +5%", "reward_def", "mul", "1 + battle upgrade Reward DEF +5%", () => 1 + 0.05 * this.battle_upgrades["reward_def+5%"]);
              this.addEffect("Battle upgrade Reward EXP +5%", "reward_exp", "mul", "1 + battle upgrade Reward EXP +5%", () => 1 + 0.05 * this.battle_upgrades["reward_exp+5%"]);
              this.addEffect("Battle upgrade Critical +0.2%", "critical", "indep", "1 + battle upgrade Critical +0.2%", () => 0.002 * this.battle_upgrades["critical+0.2%"]);
              this.addEffect("Battle upgrade Critical Damage +5%", "criticalDamage", "mul", "1 + battle upgrade Critical Damage +5%", () => 1 + 0.05 * this.battle_upgrades["criticalDamage+5%"]);
              this.addEffect("Battle upgrade Attack Speed +0.5%", "attack_speed", "mul", "1 + battle upgrade Attack Speed +0.5%", () => 1 + 0.005 * this.battle_upgrades["attack_speed+0.5%"]);
              this.addEffect("Battle upgrade Max Level +1", "battle_upgrade_max_level", "indep", "1 + battle upgrade Max Level +1", () => this.battle_upgrades["battle_upgrade_max_level+1"]);
              this.addEffect("Battle upgrade ATK and DEF from PI", "atk_and_def_from_pi", "add", "1 + battle upgrade ATK and DEF from PI", () => this.battle_upgrades["atk_and_def_from_pi+1"]);
              this.addEffect("Battle upgrade EXP from Gamma", "exp_from_gamma", "add", "1 + battle upgrade EXP from Gamma", () => this.battle_upgrades["exp_from_gamma+1"]);
              this.addEffect("Battle upgrade Critical Damage from Napier", "s_critical_from_napier", "add", "1 + battle upgrade Critical Damage from Napier", () => this.battle_upgrades["s_critical_from_napier+1"]);
              this.addEffect("Battle upgrade Math Skill", "math_skill", "add", "1 + battle upgrade Math Skill", () => 100 * this.battle_upgrades["math_skill+100"]);
              this.addEffect("Battle upgrade HP +10%", "hp", "mul", "1 + battle upgrade HP +10%", () => 1 + 0.1 * this.battle_upgrades["hp+10%"]);
              this.addEffect("Battle upgrade ATK +10%", "atk", "mul", "1 + battle upgrade ATK +10%", () => 1 + 0.1 * this.battle_upgrades["atk+10%"]);
              this.addEffect("Battle upgrade DEF +10%", "def", "mul", "1 + battle upgrade DEF +10%", () => 1 + 0.1 * this.battle_upgrades["def+10%"]);
              this.addEffect("Battle upgrade Reward HP +10%", "reward_hp", "mul", "1 + battle upgrade Reward HP +10%", () => 1 + 0.1 * this.battle_upgrades["reward_hp+10%"]);
              this.addEffect("Battle upgrade Reward ATK +10%", "reward_atk", "mul", "1 + battle upgrade Reward ATK +10%", () => 1 + 0.1 * this.battle_upgrades["reward_atk+10%"]);
              this.addEffect("Battle upgrade Reward DEF +10%", "reward_def", "mul", "1 + battle upgrade Reward DEF +10%", () => 1 + 0.1 * this.battle_upgrades["reward_def+10%"]);
              this.addEffect("Battle upgrade Reward EXP +10%", "reward_exp", "mul", "1 + battle upgrade Reward EXP +10%", () => 1 + 0.1 * this.battle_upgrades["reward_exp+10%"]);
              this.addEffect("Battle upgrade Rare Drop +0.1%", "rare_drop", "mul", "1 + battle upgrade Rare Drop +0.1%", () => 1 + 0.001 * this.battle_upgrades["rare_chance+0.1%"]);
              this.addEffect("Battle upgrade Max Level 2", "battle_upgrade_max_level_2", "add", "1 + battle upgrade Max Level 2", () => this.battle_upgrades["battle_upgrade_max_level_2+1"]);
            
              // SpiralEquipmentContainer
              this.addEffect("Spiral Equation thales", "hp", "mul", "spiral equation thales", () => 1 + 0.01 * this.dto.spiralEquipment_level[EquationKind.thales] + 0.001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.thales] - 1000));
              this.addEffect("Spiral Equation Hypatia", "def", "mul", "spiral equation Hypatia", () => 1 + 0.01 * this.dto.spiralEquipment_level[EquationKind.Hypatia] + 0.001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.Hypatia] - 1000));
              this.addEffect("Spiral Equation archimedes", "atk", "mul", "spiral equation archimedes", () => 1 + 0.01 * this.dto.spiralEquipment_level[EquationKind.archimedes] + 0.001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.archimedes] - 1000));
              this.addEffect("Spiral Equation pythagoras", "criticalDamage", "mul", "spiral equation pythagoras", () => 1 + 0.01 * this.dto.spiralEquipment_level[EquationKind.pythagoras] + 0.001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.pythagoras] - 1000));
              this.addEffect("Spiral Equation euclides", "critical", "mul", "spiral equation euclides", () => 1 + 0.001 * this.dto.spiralEquipment_level[EquationKind.euclides] + 0.0001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.euclides] - 50));
              this.addEffect("Spiral Equation eratos", "attack_speed", "mul", "spiral equation eratos", () => 1 + 0.01 * Math.log10(this.dto.spiralEquipment_level[EquationKind.eratos] + 1));
              this.addEffect("Spiral Equation Aryabhata", "super_critical", "add", "spiral equation Aryabhata", () => 0.01 * Math.log10(this.dto.spiralEquipment_level[EquationKind.Aryabhata] + 1));
              this.addEffect("Spiral Equation brahmagupta", "equation_speed", "mul", "spiral equation brahmagupta", () => 1 + 0.01 * this.dto.spiralEquipment_level[EquationKind.brahmagupta] + 0.001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.brahmagupta] - 1000));
              this.addEffect("Spiral Equation khuwarizmi", "reward_hp_mul", "mul", "spiral equation khuwarizmi", () => 1 + 0.001 * this.dto.spiralEquipment_level[EquationKind.khuwarizmi] + 0.0001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.khuwarizmi] - 1000));
              this.addEffect("Spiral Equation omar", "reward_atk_mul", "mul", "spiral equation omar", () => 1 + 0.001 * this.dto.spiralEquipment_level[EquationKind.omar] + 0.0001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.omar] - 1000));
              this.addEffect("Spiral Equation bhaskara", "reward_def_mul", "mul", "spiral equation bhaskara", () => 1 + 0.001 * this.dto.spiralEquipment_level[EquationKind.bhaskara] + 0.0001 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.bhaskara] - 1000));
              this.addEffect("Spiral Equation madhava", "reward_exp_mul", "mul", "spiral equation madhava", () => 1 + 0.0005 * this.dto.spiralEquipment_level[EquationKind.madhava] + 0.00005 * Math.max(0, this.dto.spiralEquipment_level[EquationKind.madhava] - 1000));
            
              // Challenge / ChallengeContainer
              this.addEffect("Challenge SlowSpiral First Clear Reward", "softPrestigeSkip", "add", "1 if challenge SlowSpiral Reward", () => this.dto.challengeLevels[ChallengeKind.SlowSpiral] >= 1 ? 1 : 0);
              this.addEffect("Challenge SinSpiral First Clear Reward", "softPrestigeSkip", "add", "1 if challenge SinSpiral Reward", () => this.dto.challengeLevels[ChallengeKind.SinSpiral] >= 1 ? 1 : 0);
              this.addEffect("Challenge StraightLine First Clear Reward", "softPrestigeSkip", "add", "1 if challenge StraightLine Reward", () => this.dto.challengeLevels[ChallengeKind.StraightLine] >= 1 ? 1 : 0);
              this.addEffect("Challenge drain First Clear Reward", "softPrestigeSkip", "add", "1 if challenge drain Reward", () => this.dto.challengeLevels[ChallengeKind.drain] >= 1 ? 1 : 0);
              this.addEffect("Challenge poorMath First Clear Reward", "softPrestigeSkip", "add", "1 if challenge poorMath Reward", () => this.dto.challengeLevels[ChallengeKind.poorMath] >= 1 ? 1 : 0);
              
              this.addEffect("Challenge basic Reward", "delta_r", "mul", "1 + 0.5 * challenge basic Reward", () => 1 + 0.5 * this.dto.challengeLevels[ChallengeKind.basic]);
              this.addEffect("Challenge SlowSpiral Reward", "omega", "mul", "1 + 0.1 * challenge SlowSpiral Reward", () => 1 + 0.1 * this.dto.challengeLevels[ChallengeKind.SlowSpiral]);
              this.addEffect("Challenge SinSpiral Reward", "prestige_level_limit", "add", "challenge SinSpiral Reward", () => this.dto.challengeLevels[ChallengeKind.SinSpiral]);
              this.addEffect("Challenge StraightLine Reward", "k", "mul", "1 + challenge StraightLine Reward", () => 1 + this.dto.challengeLevels[ChallengeKind.StraightLine]);
              this.addEffect("Challenge drain Reward", "tornado_cost_reduction", "add", "-0.1 * challenge drain Reward", () => -0.1 * this.dto.challengeLevels[ChallengeKind.drain]);
              
              this.addEffect("Challenge poorMath Reward", "delta_r", "mul", "challenge poorMath Reward", () => {
                var value = 1;
                if (this.dto.challengeLevels[ChallengeKind.poorMath] >= 1) {
                  value *= this.evaluate("a");
                  value *= this.evaluate("b");
                  value *= this.evaluate("c");
                }
                if (this.dto.challengeLevels[ChallengeKind.poorMath] >= 2)
                  value *= this.evaluate("d");
                if (this.dto.challengeLevels[ChallengeKind.poorMath] >= 3)
                  value *= this.evaluate("e");
                if (this.dto.challengeLevels[ChallengeKind.poorMath] >= 4)
                  value *= this.evaluate("f");
                if (this.dto.challengeLevels[ChallengeKind.poorMath] >= 5)
                  value *= this.evaluate("g");
                
                return value ** (1/11);
              });
              this.addEffect("Challenge no_rebirth Reward", "automation_interval", "mul", "0.5 ** challenge no_rebirth Reward", () => 0.5 ** this.dto.challengeLevels[ChallengeKind.no_rebirth]);
              this.addEffect("Challenge drunk Reward", "omegaExponent", "add", "0.1 * challenge drunk Reward", () => 0.1 * this.dto.challengeLevels[ChallengeKind.drunk]);
              this.addEffect("Challenge gluttony Reward atk", "atk", "mul", "1 + 0.2 * challenge gluttony Reward", () => 1 + 0.2 * this.dto.challengeLevels[ChallengeKind.gluttony]);
              this.addEffect("Challenge gluttony Reward hp", "hp", "mul", "1 + 0.2 * challenge gluttony Reward", () => 1 + 0.2 * this.dto.challengeLevels[ChallengeKind.gluttony]);
              this.addEffect("Challenge gluttony Reward def", "def", "mul", "1 + 0.2 * challenge gluttony Reward", () => 1 + 0.2 * this.dto.challengeLevels[ChallengeKind.gluttony]);
              this.addEffect("Challenge sinkhole Reward", "delta_r", "mul", "1 + log(timeSinceOmegaPrestige / 13 + 1) / log(10 - challenge sinkhole Reward)", () => 1 + Math.log(this.dto.timeSinceOmegaPrestige / 13 + 1) / Math.log(10 - this.dto.challengeLevels[ChallengeKind.sinkhole]));
              this.addEffect("Challenge sphere Reward z_reactor_exp", "z_reactor_exp", "mul", "1 + challenge sphere Reward", () => 1 + (this.dto.challengeLevels[ChallengeKind.sphere] >= 1));
              this.addEffect("Challenge sphere Reward z_reactor_cap", "z_reactor_cap", "mul", "1 + 0.05 * challenge sphere Reward", () => 1 + 0.05 * this.dto.challengeLevels[ChallengeKind.sphere]);
              this.addEffect("Challenge fury Reward", "enemy_growth_reduction", "mul", "0.95 ** challenge fury Reward", () => 0.95 ** this.dto.challengeLevels[ChallengeKind.fury]);
            
              // SpiralDesignEffect
              this.addEffect("Spiral Design normal_brue active", "a", "mul", "1.1 if Spiral Design normal_brue active", () => this.dto.currentDesign == DesignID.normal_brue ? 1.1 : 1);
              this.addEffect("Spiral Design normal_yellow active", "b", "mul", "1.1 if Spiral Design normal_yellow active", () => this.dto.currentDesign == DesignID.normal_yellow ? 1.1 : 1);
              this.addEffect("Spiral Design normal_red active", "c", "mul", "1.1 if Spiral Design normal_red active", () => this.dto.currentDesign == DesignID.normal_red ? 1.1 : 1);
              this.addEffect("Spiral Design normal_violet active", "d", "mul", "1.1 if Spiral Design normal_violet active", () => this.dto.currentDesign == DesignID.normal_violet ? 1.1 : 1);
              this.addEffect("Spiral Design normal_mono active", "e", "mul", "1.1 if Spiral Design normal_mono active", () => this.dto.currentDesign == DesignID.normal_mono ? 1.1 : 1);
              
              this.addEffect("Spiral Design gradation_brue_green active", "hp", "mul", "1.5 if Spiral Design gradation_brue_green active", () => this.dto.currentDesign == DesignID.gradation_brue_green ? 1.5 : 1);
              this.addEffect("Spiral Design gradation_brue_green passive", "hp", "mul", "1.1 if Spiral Design gradation_brue_green passive", () => this.dto.design_isUnlocked[DesignID.gradation_brue_green] ? 1.1 : 1);
              
              this.addEffect("Spiral Design gradation_yellow_red active", "atk", "mul", "1.5 if Spiral Design gradation_yellow_red active", () => this.dto.currentDesign == DesignID.gradation_yellow_red ? 1.5 : 1);
              this.addEffect("Spiral Design gradation_yellow_red passive", "atk", "mul", "1.1 if Spiral Design gradation_yellow_red passive", () => this.dto.design_isUnlocked[DesignID.gradation_yellow_red] ? 1.1 : 1);

              this.addEffect("Spiral Design gradation_red_blue active", "def", "mul", "1.5 if Spiral Design gradation_red_blue active", () => this.dto.currentDesign == DesignID.gradation_red_blue ? 1.5 : 1);
              this.addEffect("Spiral Design gradation_red_blue passive", "def", "mul", "1.1 if Spiral Design gradation_red_blue passive", () => this.dto.design_isUnlocked[DesignID.gradation_red_blue] ? 1.1 : 1);
              
              this.addEffect("Spiral Design gradation_violet_pink active", "critical", "mul", "1.05 if Spiral Design gradation_violet_pink active", () => this.dto.currentDesign == DesignID.gradation_violet_pink ? 1.05 : 1);
              this.addEffect("Spiral Design gradation_violet_pink passive", "critical", "mul", "1.01 if Spiral Design gradation_violet_pink passive", () => this.dto.design_isUnlocked[DesignID.gradation_violet_pink] ? 1.01 : 1);

              this.addEffect("Spiral Design gradation_white_cyan active", "criticalDamage", "mul", "1.2 if Spiral Design gradation_white_cyan active", () => this.dto.currentDesign == DesignID.gradation_white_cyan ? 1.2 : 1);
              this.addEffect("Spiral Design gradation_white_cyan passive", "criticalDamage", "mul", "1.01 if Spiral Design gradation_white_cyan passive", () => this.dto.design_isUnlocked[DesignID.gradation_white_cyan] ? 1.01 : 1);

              this.addEffect("Spiral Design circles_white active", "regene_while_resting", "mul", "3 if Spiral Design circles_white active", () => this.dto.currentDesign == DesignID.circles_white ? 3 : 1);
              this.addEffect("Spiral Design circles_white passive", "regene_while_resting", "mul", "1.5 if Spiral Design circles_white passive", () => this.dto.design_isUnlocked[DesignID.circles_white] ? 1.5 : 1);

              this.addEffect("Spiral Design circles_green_pink active regene_while_resting", "regene_while_resting", "mul", "1.5 if Spiral Design circles_green_pink active", () => this.dto.currentDesign == DesignID.circles_green_pink ? 1.5 : 1);
              this.addEffect("Spiral Design circles_green_pink active def", "def", "mul", "1.3 if Spiral Design circles_green_pink active", () => this.dto.currentDesign == DesignID.circles_green_pink ? 1.3 : 1);
              this.addEffect("Spiral Design circles_green_pink passive regene_while_resting", "regene_while_resting", "mul", "1.1 if Spiral Design circles_green_pink passive", () => this.dto.design_isUnlocked[DesignID.circles_green_pink] ? 1.1 : 1);
              this.addEffect("Spiral Design circles_green_pink passive def", "def", "mul", "1.05 if Spiral Design circles_green_pink passive", () => this.dto.design_isUnlocked[DesignID.circles_green_pink] ? 1.05 : 1);
              
              this.addEffect("Spiral Design circles_cyan_red active regene_while_resting", "regene_while_resting", "mul", "1.5 if Spiral Design circles_cyan_red active", () => this.dto.currentDesign == DesignID.circles_cyan_red ? 1.5 : 1);
              this.addEffect("Spiral Design circles_cyan_red active atk", "atk", "mul", "1.3 if Spiral Design circles_cyan_red active", () => this.dto.currentDesign == DesignID.circles_cyan_red ? 1.3 : 1);
              this.addEffect("Spiral Design circles_cyan_red passive regene_while_resting", "regene_while_resting", "mul", "1.1 if Spiral Design circles_cyan_red passive", () => this.dto.design_isUnlocked[DesignID.circles_cyan_red] ? 1.1 : 1);
              this.addEffect("Spiral Design circles_cyan_red passive atk", "atk", "mul", "1.05 if Spiral Design circles_cyan_red passive", () => this.dto.design_isUnlocked[DesignID.circles_cyan_red] ? 1.05 : 1);

              this.addEffect("Spiral Design dottedLine_blue active", "line_number_multiplier", "mul", "2 if Spiral Design dottedLine_blue active", () => this.dto.currentDesign == DesignID.dottedLine_blue ? 2 : 1);
              this.addEffect("Spiral Design dottedLine_blue passive", "line_number_multiplier", "mul", "1.25 if Spiral Design dottedLine_blue passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_blue] ? 1.25 : 1);
              
              this.addEffect("Spiral Design dottedLine_white active", "line_number_multiplier", "mul", "1.25 if Spiral Design dottedLine_white active", () => this.dto.currentDesign == DesignID.dottedLine_white ? 1.25 : 1);
              this.addEffect("Spiral Design dottedLine_white passive line_number_multiplier", "line_number_multiplier", "mul", "1.1 if Spiral Design dottedLine_white passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_white] ? 1.1 : 1);
              this.addEffect("Spiral Design dottedLine_white passive a", "a", "mul", "1.05 if Spiral Design dottedLine_white passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_white] ? 1.05 : 1);
              this.addEffect("Spiral Design dottedLine_white passive b", "b", "mul", "1.05 if Spiral Design dottedLine_white passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_white] ? 1.05 : 1);
              this.addEffect("Spiral Design dottedLine_white passive c", "c", "mul", "1.05 if Spiral Design dottedLine_white passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_white] ? 1.05 : 1);

              this.addEffect("Spiral Design dottedLine_orange_brue active", "line_number_multiplier", "mul", "1.25 if Spiral Design dottedLine_orange_brue active", () => this.dto.currentDesign == DesignID.dottedLine_orange_brue ? 1.25 : 1);
              this.addEffect("Spiral Design dottedLine_orange_brue passive line_number_multiplier", "line_number_multiplier", "mul", "1.1 if Spiral Design dottedLine_orange_brue passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_orange_brue] ? 1.1 : 1);
              this.addEffect("Spiral Design dottedLine_orange_brue passive d", "d", "mul", "1.05 if Spiral Design dottedLine_orange_brue passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_orange_brue] ? 1.05 : 1);
              this.addEffect("Spiral Design dottedLine_orange_brue passive e", "e", "mul", "1.05 if Spiral Design dottedLine_orange_brue passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_orange_brue] ? 1.05 : 1);
              this.addEffect("Spiral Design dottedLine_orange_brue passive f", "f", "mul", "1.05 if Spiral Design dottedLine_orange_brue passive", () => this.dto.design_isUnlocked[DesignID.dottedLine_orange_brue] ? 1.05 : 1);

              this.addEffect("Spiral Design stripe_white active", "v", "add", "5 if Spiral Design stripe_white active", () => this.dto.currentDesign == DesignID.stripe_white ? 5 : 0);
              this.addEffect("Spiral Design stripe_white passive", "v", "add", "2 if Spiral Design stripe_white passive", () => this.dto.design_isUnlocked[DesignID.stripe_white] ? 2 : 0);
              
              this.addEffect("Spiral Design stripe_blue active", "reward_atk", "add", "5 if Spiral Design stripe_blue active", () => this.dto.currentDesign == DesignID.stripe_blue ? 5 : 0);
              this.addEffect("Spiral Design stripe_blue passive", "reward_atk", "add", "2 if Spiral Design stripe_blue passive", () => this.dto.design_isUnlocked[DesignID.stripe_blue] ? 2 : 0);

              this.addEffect("Spiral Design stripe_yellow active", "reward_def", "add", "5 if Spiral Design stripe_yellow active", () => this.dto.currentDesign == DesignID.stripe_yellow ? 5 : 0);
              this.addEffect("Spiral Design stripe_yellow passive", "reward_def", "add", "2 if Spiral Design stripe_yellow passive", () => this.dto.design_isUnlocked[DesignID.stripe_yellow] ? 2 : 0);

              this.addEffect("Spiral Design sine_green active", "reward_exp", "add", "3 if Spiral Design sine_green active", () => this.dto.currentDesign == DesignID.sine_green ? 3 : 0);
              this.addEffect("Spiral Design sine_green passive", "reward_exp", "add", "1 if Spiral Design sine_green passive", () => this.dto.design_isUnlocked[DesignID.sine_green] ? 1 : 0);

              this.addEffect("Spiral Design sine_white_red active", "reward_exp_mul", "mul", "1.1 if Spiral Design sine_white_red active", () => this.dto.currentDesign == DesignID.sine_white_red ? 1.1 : 1);
              this.addEffect("Spiral Design sine_white_red passive", "reward_exp_mul", "mul", "1.03 if Spiral Design sine_white_red passive", () => this.dto.design_isUnlocked[DesignID.sine_white_red] ? 1.03 : 1);

              this.addEffect("Spiral Design sine_orange_purple active hp", "hp", "mul", "2 if Spiral Design sine_orange_purple active", () => this.dto.currentDesign == DesignID.sine_orange_purple ? 2 : 1);
              this.addEffect("Spiral Design sine_orange_purple active atk", "atk", "mul", "2 if Spiral Design sine_orange_purple active", () => this.dto.currentDesign == DesignID.sine_orange_purple ? 2 : 1);
              this.addEffect("Spiral Design sine_orange_purple active def", "def", "mul", "2 if Spiral Design sine_orange_purple active", () => this.dto.currentDesign == DesignID.sine_orange_purple ? 2 : 1);
              this.addEffect("Spiral Design sine_orange_purple passive hp", "hp", "mul", "1.3 if Spiral Design sine_orange_purple passive", () => this.dto.design_isUnlocked[DesignID.sine_orange_purple] ? 1.3 : 1);
              this.addEffect("Spiral Design sine_orange_purple passive atk", "atk", "mul", "1.3 if Spiral Design sine_orange_purple passive", () => this.dto.design_isUnlocked[DesignID.sine_orange_purple] ? 1.3 : 1);
              this.addEffect("Spiral Design sine_orange_purple passive def", "def", "mul", "1.3 if Spiral Design sine_orange_purple passive", () => this.dto.design_isUnlocked[DesignID.sine_orange_purple] ? 1.3 : 1);

              this.addEffect("Spiral Design snake active", "super_critical", "add", "0.1 if Spiral Design snake active", () => this.dto.currentDesign == DesignID.snake ? 0.1 : 0);
              this.addEffect("Spiral Design snake passive", "super_critical", "add", "0.03 if Spiral Design snake passive", () => this.dto.design_isUnlocked[DesignID.snake] ? 0.03 : 0);

              this.addEffect("Spiral Design bubble active", "rare_drop", "mul", "1.2 if Spiral Design bubble active", () => this.dto.currentDesign == DesignID.bubble ? 1.2 : 1);
              this.addEffect("Spiral Design bubble passive", "rare_drop", "mul", "1.05 if Spiral Design bubble passive", () => this.dto.design_isUnlocked[DesignID.bubble] ? 1.05 : 1);

              this.addEffect("Spiral Design arrow active", "attack_speed", "mul", "1.2 if Spiral Design arrow active", () => this.dto.currentDesign == DesignID.arrow ? 1.2 : 1);
              this.addEffect("Spiral Design arrow passive", "attack_speed", "mul", "1.05 if Spiral Design arrow passive", () => this.dto.design_isUnlocked[DesignID.arrow] ? 1.05 : 1);

              this.addEffect("Spiral Design pi active", "Omega", "mul", "1.5 if Spiral Design pi active", () => this.dto.currentDesign == DesignID.pi ? 1.5 : 1);
              this.addEffect("Spiral Design pi passive", "Omega", "mul", "1.2 if Spiral Design pi passive", () => this.dto.design_isUnlocked[DesignID.pi] ? 1.2 : 1);

              this.addEffect("Spiral Design rects active", "reward_exp_mul", "mul", "1.05 if Spiral Design rects active", () => this.dto.currentDesign == DesignID.rects ? 1.05 : 1);
              this.addEffect("Spiral Design rects passive", "battle_upgrade_cost", "mul", "0.95 if Spiral Design rects passive", () => this.dto.design_isUnlocked[DesignID.rects] ? 0.95 : 1);
              
              this.addEffect("Spiral Design rainbow active", "equation_speed", "mul", "2 if Spiral Design rainbow active", () => this.dto.currentDesign == DesignID.rainbow ? 2 : 1);
              this.addEffect("Spiral Design rainbow passive", "equation_speed", "mul", "1.5 if Spiral Design rainbow passive", () => this.dto.design_isUnlocked[DesignID.rainbow] ? 1.5 : 1);

              this.addEffect("Spiral Design kanji active", "delta", "mul", "2 if Spiral Design kanji active", () => this.dto.currentDesign == DesignID.kanji ? 2 : 1);
              this.addEffect("Spiral Design kanji passive", "equation_slot", "add", "1 if Spiral Design kanji passive", () => this.dto.design_isUnlocked[DesignID.kanji] ? 1 : 0);

              this.addEffect("Spiral Design rahmen active", "gamma", "mul", "1.5 if Spiral Design rahmen active", () => this.dto.currentDesign == DesignID.rahmen ? 1.5 : 1);
              this.addEffect("Spiral Design rahmen passive", "gamma", "mul", "1.2 if Spiral Design rahmen passive", () => this.dto.design_isUnlocked[DesignID.rahmen] ? 1.2 : 0);

              this.addEffect("Spiral Design lazer active", "z_reactor_exp", "mul", "1.5 if Spiral Design lazer active", () => this.dto.currentDesign == DesignID.lazer ? 1.5 : 1);
              this.addEffect("Spiral Design lazer passive", "z_reactor_exp", "mul", "1.2 if Spiral Design lazer passive", () => this.dto.design_isUnlocked[DesignID.lazer] ? 1.2 : 0);

              this.addEffect("Spiral Design spaceShip active", "omega", "mul", "1.1 if Spiral Design spaceShip active", () => this.dto.currentDesign == DesignID.spaceShip ? 1.1 : 1);
              this.addEffect("Spiral Design spaceShip passive", "omega", "mul", "1.1 if Spiral Design spaceShip passive", () => this.dto.design_isUnlocked[DesignID.spaceShip] ? 1.1 : 1);
              
              this.addEffect("Spiral Design seigaiha active", "alpha", "add", "0.025 if Spiral Design seigaiha active", () => this.dto.currentDesign == DesignID.seigaiha ? 0.025 : 0);
              this.addEffect("Spiral Design seigaiha passive", "alpha", "add", "0.01 if Spiral Design seigaiha passive", () => this.dto.design_isUnlocked[DesignID.seigaiha] ? 0.01 : 0);

              this.addEffect("Spiral Design sippou active", "beta", "add", "0.025 if Spiral Design sippou active", () => this.dto.currentDesign == DesignID.sippou ? 0.025 : 0);
              this.addEffect("Spiral Design sippou passive", "beta", "add", "0.01 if Spiral Design sippou passive", () => this.dto.design_isUnlocked[DesignID.sippou] ? 0.01 : 0);

              this.addEffect("Spiral Design lame active", "math_skill", "add", "1000 if Spiral Design lame active", () => this.dto.currentDesign == DesignID.lame ? 1000 : 0);
              this.addEffect("Spiral Design lame passive", "math_skill", "add", "200 if Spiral Design lame passive", () => this.dto.design_isUnlocked[DesignID.lame] ? 200 : 0);
              
              // ReactorContainer
              this.addEffect("Reactor r active", "delta_r", "mul", "1 + 0.01 * reactor value", () => 1 + 0.01 * this.reactor_values["r"]);
              this.addEffect("Reactor r passive", "delta_r", "mul", "Its complicated", () => {
                if ( this.reactor_levels["r"] >= 1000 )
                  return 1 + 0.005 * this.reactor_levels["r"] + 0.00005 * (this.reactor_levels["r"] - 1000);
                else
                  return 1 + 0.005 * this.reactor_levels["r"];
              });

              this.addEffect("Reactor lineRenderer active", "line_number_multiplier", "mul", "1 + 0.01 * (reactor value ** 1.8) / 25000", () => 1 + 0.01 * (this.reactor_values["lineRenderer"] ** 1.8) / 25000);
              this.addEffect("Reactor lineRenderer passive", "line_number_multiplier", "mul", "Its complicated", () => {
                if ( this.reactor_levels["lineRenderer"] >= 1000 )
                  return 1 + 0.005 * this.reactor_levels["lineRenderer"] + 0.0005 * (this.reactor_levels["lineRenderer"] - 1000);
                else
                  return 1 + 0.05 * this.reactor_levels["lineRenderer"];
              });

              this.addEffect("Reactor equation active", "equation_speed", "mul", "1 + 0.01 * (reactor value ** 1.5) / 20000", () => 1 + 0.01 * (this.reactor_values["equation"] ** 1.5) / 20000);
              this.addEffect("Reactor equation passive", "equation_speed", "mul", "Its complicated", () => {
                if ( this.reactor_levels["equation"] >= 1000 )
                  return 1 + 0.005 * this.reactor_levels["equation"] + 0.00025 * (this.reactor_levels["equation"] - 1000);
                else
                  return 1 + 0.025 * this.reactor_levels["equation"];
              });

              this.addEffect("Reactor battle_stats active hp", "hp", "mul", "1 + 0.01 * (reactor value ** 3) / 1e14", () => 1 + 0.01 * (this.reactor_values["battle_stats"] ** 3) / 1e14);
              this.addEffect("Reactor battle_stats active atk", "atk", "mul", "1 + 0.01 * (reactor value ** 3) / 1e14", () => 1 + 0.01 * (this.reactor_values["battle_stats"] ** 3) / 1e14);
              this.addEffect("Reactor battle_stats active def", "def", "mul", "1 + 0.01 * (reactor value ** 3) / 1e14", () => 1 + 0.01 * (this.reactor_values["battle_stats"] ** 3) / 1e14);
              this.addEffect("Reactor battle_stats passive hp", "hp", "mul", "Its complicated", () => {
                if ( this.reactor_levels["battle_stats"] >= 1000 )
                  return 1 + 0.005 * this.reactor_levels["battle_stats"] + 0.0005 * (this.reactor_levels["battle_stats"] - 1000);
                else
                  return 1 + 0.05 * this.reactor_levels["battle_stats"];
              });
              this.addEffect("Reactor battle_stats passive atk", "atk", "mul", "Its complicated", () => {
                if ( this.reactor_levels["battle_stats"] >= 1000 )
                  return 1 + 0.005 * this.reactor_levels["battle_stats"] + 0.0005 * (this.reactor_levels["battle_stats"] - 1000);
                else
                  return 1 + 0.05 * this.reactor_levels["battle_stats"];
              });
              this.addEffect("Reactor battle_stats passive def", "def", "mul", "Its complicated", () => {
                if ( this.reactor_levels["battle_stats"] >= 1000 )
                  return 1 + 0.005 * this.reactor_levels["battle_stats"] + 0.0005 * (this.reactor_levels["battle_stats"] - 1000);
                else
                  return 1 + 0.05 * this.reactor_levels["battle_stats"];
              });

              this.addEffect("Reactor crit active", "critical", "indep", "0.01 * SigmaSum(Math.floor(reactor value / 1e9))", () => 0.01 * SigmaSum(Math.floor(this.reactor_values["crit"] / 1e9)));
              this.addEffect("Reactor crit passive", "critical", "indep", "Its complicated", () => {
                if ( this.reactor_levels["crit"] >= 1000 )
                  return 0.000005 * this.reactor_levels["crit"] + 0.00005 * this.reactor_levels["crit"];
                else
                  return 0.00005 * this.reactor_levels["crit"];
              });

              this.addEffect("Reactor super_critical active", "super_critical", "indep", "0.01 * Math.floor(reactor value / 2e16)", () => 0.01 * Math.floor(this.reactor_values["s_crit"] / 2e16));
              this.addEffect("Reactor super_critical passive", "super_critical", "indep", "Its complicated", () => {
                if ( this.reactor_levels["s_crit"] >= 1000 )
                  return 0.000005 * this.reactor_levels["s_crit"] + 0.00005 * this.reactor_levels["s_crit"];
                else
                  return 0.00005 * this.reactor_levels["s_crit"];
              });
            }
            
            this.debug = function ( ) {
              console.log(this);
              for ( var effect in this.effects ) {
                var value = this.effects[effect].value();
                console.log(effect + ": " + value);
                if ( value != value ) {
                  console.log(this.effects[effect].value);
                  throw "NaN";
                }
              }
            }
          }

          idlespiral.init();

          const ChallengeKind = {
            none: 0,
            basic: 1,
            SlowSpiral: 2,
            SinSpiral: 3,
            StraightLine: 4,
            drain: 5,
            poorMath: 6,
            no_rebirth: 7,
            drunk: 8,
            gluttony: 9,
            sinkhole: 10,
            sphere: 11,
            fury: 12,
            lava: 13,
            go_back: 14,
          }
          const DesignID = {
            normal_brue: 0,
            normal_yellow: 1,
            normal_red: 2,
            normal_violet: 3,
            normal_mono: 4,
            gradation_brue_green: 5,
            gradation_yellow_red: 6,
            gradation_red_blue: 7,
            gradation_violet_pink: 8,
            gradation_white_cyan: 9,
            circles_white: 10,
            circles_green_pink: 11,
            circles_cyan_red: 12,
            dottedLine_blue: 13,
            dottedLine_white: 14,
            dottedLine_orange_brue: 15,
            stripe_white: 16,
            stripe_blue: 17,
            stripe_yellow: 18,
            sine_green: 19,
            sine_white_red: 20,
            sine_orange_purple: 21,
            snake: 22,
            bubble: 23,
            arrow: 24,
            pi: 25,
            rects: 26,
            rainbow: 27,
            kanji: 28,
            rahmen: 29,
            lazer: 30,
            spaceShip: 31,
            seigaiha: 32,
            sippou: 33,
            lame: 34,
          }
          const EquationKind = {
	          thales: 0,
            Hypatia: 1,
            archimedes: 2,
            pythagoras: 3,
            euclides: 4,
            eratos: 5,
            Aryabhata: 6,
            brahmagupta: 7,
            khuwarizmi: 8,
            omar: 9,
            bhaskara: 10,
            madhava: 11,
          }
          
          const UnlockWithTornado = {
            AutoPrestige: 0,
            AutoOmegaPrestige: 1,
            Challenge: 2,
            Challenge_Drain: 3,
            Challenge_drunk: 4,
            Challenge_noRebirth: 5,
            Challenge_gluttony: 6,
            Challenge_sinkhole: 7,
            Enemy_PI: 8,
            Enemy_Gamma: 9,
            Enemy_Napier: 10,
            Challenge_Flower: 11,
            Exponent_A: 12,
            Challenge_Slow: 13,
            Z_boolster: 14,
            Challenge_Straight: 15,
            NewSigma: 16,
            Challenge_Poor: 17,
            Equation: 18,
            critical: 19,
            m: 20,
            integral: 21,
            Challenge_sphere: 22,
            new_battle_upgrade: 23,
            z_reactor_c: 24,
            z_reactor_cx: 25,
            Enemy_penta: 26,
            Challenge_fury: 27,
            new_battle_upgrade_2: 28,
          }
          
          function diminishedAttackSpeed ( pure_attack_speed ) {
            if ( pure_attack_speed < 4 )
              return 1 + pure_attack_speed;
            return ( 17.5 * pure_attack_speed + 55 ) ** (1/3);
          }
          function diminishedRareChance ( pure_rare_chance ) {
            if ( pure_rare_chance < 0.5 )
              return 1 + pure_rare_chance;
            if ( pure_rare_chance < 5.5 )
              return 1.5 + ( pure_rare_chance - 0.5 ) * 0.05;
            return 1.75 + ( pure_rare_chance - 0.75 ) * 0.001;
          }
          function decay ( math_skill ) {
            if ( math_skill < 50000 )
              return 1 - 0.5 * math_skill / 50000;
            return 1 - (0.9 - 1 / 1.000018326 ** math_skill);
          }
          function HourFactor ( hour ) {
            if (hour <= 100.0)
              return hour * 1.0 * 0.01;
            if (hour <= 1000.0)
              return hour * 1.0 * 0.01 + (hour - 100.0) * 1.0 * 0.005;
            return hour * 1.0 * 0.01 + (hour - 100.0) * 1.0 * 0.005 + (hour - 1100.0) * 1.0 * 0.001;
          }
          function SigmaSum ( level ) {
            var r = 0;
            for ( var i = 0; i < level; i++ )
              r += 1 / Math.sqrt(i + 1);
            return r;
          }

          function loadSaveFile ( ) {
            val = $.trim($("#savefiletextarea").val());
            if ( val == "" ) {
              alert("No save file specified!");
              return;
            }
            idlespiral.loadSave(val);
            idlespiral.debug();
            idlespiral.update();
          }
        </script>
    </head>
    <body>

      <img src="https://visitor-badge.glitch.me/badge?page_id=kloppie5.idlespiralinforepo" alt="visitor counter" /><br/>

      v0.2206261714<br/>
      <textarea id="savefiletextarea" rows="10" cols="50" placeholder="Save file here"></textarea>
      <button onclick="loadSaveFile()">Load</button>

      <div class="marked" style="position: absolute; width: 1500px; height: 1000px">
        <div class="marked" style="position: absolute; width: 420px; height: 500px">
          <div class="marked" style="position: absolute; width: 420px; height: 400px;">
            <div class="formula marked" style="height: 50px">
              <div class="marked explainable explain_delta_r">$\Delta r$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="marked explainable explain_m">$\displaystyle\sum\limits_{l_2=1}^m$</div>
              <div class="marked explainable explain_sigmaA">$\displaystyle\sum\limits_{l=1}^n A_l$</div>
              <div class="marked explainable explain_omega">$\omega^{omegaExponent}$</div>
              <div>+</div>
              <div class="marked explainable explain_k">$k$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_delta_r">0</div>
            </div>
            <div class="formula marked" style="position: absolute; top: 50px; height: 65px">
              <div class="marked explainable explain_sigmaA">$A_i$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="marked explainable explain_integral">$\displaystyle\int\limits_0^\alpha 2 x^\beta$</div>
              <div class="marked explainable explain_u">$u$</div>
              <div class="marked explainable explain_sigmaA">$A_{i-1}$</div>
              <div>$dx$</div>
              <div>+</div>
              <div class="marked explainable explain_v">$v$</div>
            </div>
            <div class="formula marked explainable explain_u" style="position: absolute; top: 115px; left: 30px; width: 120px; height: 20px">
              <div>$u$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_u">0</div>
            </div>
            <div class="formula marked explainable explain_v" style="position: absolute; top: 115px; left: 150px; width: 120px; height: 20px">
              <div>$v$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_v">0</div>
            </div>
            <div class="formula marked explainable explain_n" style="position: absolute; top: 135px; left: 30px; width: 120px; height: 20px">
              <div>$n$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_n">0</div>
            </div>
            <div class="formula marked explainable explain_m" style="position: absolute; top: 135px; left: 150px; width: 120px; height: 20px">
              <div>$m$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_m">0</div>
            </div>
            <div class="formula marked explainable explain_alpha" style="position: absolute; top: 155px; left: 30px; width: 120px; height: 20px">
              <div>$\alpha$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_alpha">0</div>
            </div>
            <div class="formula marked explainable explain_beta" style="position: absolute; top: 155px; left: 150px; width: 120px; height: 20px">
              <div>$\beta$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_beta">0</div>
            </div>
            <div class="formula marked" style="position: absolute; top: 175px; left: 30px; height: 20px">
              <div class="marked explainable explain_largeA">$A_1$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="marked explainable explain_a">$a$</div>
              <div>$\times$</div>
              <div class="marked explainable explain_b">$b$</div>
              <div>$\times$</div>
              <div class="marked explainable explain_c">$c$</div>
              <div>$\times$</div>
              <div class="marked explainable explain_d">$d$</div>
              <div>$\times$</div>
              <div class="marked explainable explain_e">$e$</div>
              <div>$\times$</div>
              <div class="marked explainable explain_f">$f$</div>
              <div>$\times$</div>
              <div class="marked explainable explain_g">$g$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_largeA explainable explain_largeA">0</div>
            </div>
            <div class="formula marked explainable explain_a" style="position: absolute; top: 195px; left: 30px; height: 20px">
              <div>$a$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_a">0</div>
            </div>
            <div class="formula marked explainable explain_b" style="position: absolute; top: 215px; left: 30px; height: 20px">
              <div>$b$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_b">0</div>
            </div>
            <div class="formula marked explainable explain_c" style="position: absolute; top: 235px; left: 30px; height: 20px">
              <div>$c$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_c">0</div>
            </div>
            <div class="formula marked explainable explain_d" style="position: absolute; top: 255px; left: 30px; height: 20px">
              <div>$d$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_d">0</div>
            </div>
            <div class="formula marked explainable explain_e" style="position: absolute; top: 275px; left: 30px; height: 20px">
              <div>$e$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_e">0</div>
            </div>
            <div class="formula marked explainable explain_f" style="position: absolute; top: 295px; left: 30px; height: 20px">
              <div>$f$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_f">0</div>
            </div>
            <div class="formula marked explainable explain_g" style="position: absolute; top: 315px; left: 30px; height: 20px">
              <div>$g$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_g">0</div>
            </div>
            <div class="formula marked explainable explain_k" style="position: absolute; top: 335px; left: 30px; height: 20px">
              <div>$k$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_k">0</div>
            </div>
            <div class="formula marked explainable explain_omega" style="position: absolute; top: 370px; left: 30px; height: 20px">
              <div>$\omega$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_omega">0</div>
            </div>
          </div>
          <div class="marked" style="position: absolute; top: 420px; width: 420px; height: 80px;">
            <div class="formula marked" style="height: 20px">
              <div class="marked explainable explain_delta_z">$\Delta z$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="marked explainable explain_gamma">$\gamma$</div>
              <div class="marked explainable explain_Omega">$\Omega$</div>
              <div>+</div>
              <div class="marked explainable explain_delta">$\delta$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_delta_z explainable explain_delta_z">0</div>
            </div>
            <div class="formula marked explainable explain_gamma" style="position: absolute; top: 20px; left: 30px; height: 20px">
              <div>$\gamma$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_gamma">0</div>
            </div>
            <div class="formula marked explainable explain_Omega" style="position: absolute; top: 40px; left: 30px; height: 20px">
              <div>$\Omega$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_Omega">0</div>
            </div>
            <div class="formula marked explainable explain_delta" style="position: absolute; top: 60px; left: 30px; height: 20px">
              <div>$\delta$</div>
              <div>&nbsp;=&nbsp;</div>
              <div class="update_display display_delta">0</div>
            </div>
          </div>
        </div>

        <div class="marked" id="main" style="position: absolute; left: 420px; width: 780px">
          <div class="explanation" id="explanation_delta_r" style="display: none">
            Explanation delta r
          </div>
          <div class="explanation" id="explanation_sigmaA" style="display: none">
            Explanation sigmaA
          </div>
          <div class="explanation" id="explanation_omega" style="display: none">
            Explanation omega
          </div>
          <div class="explanation" id="explanation_k" style="display: none">
            Explanation k
          </div>
          <div class="explanation" id="explanation_integral" style="display: none">
            Explanation integral
          </div>
          <div class="explanation" id="explanation_u" style="display: none">
            Explanation u
          </div>
          <div class="explanation" id="explanation_v" style="display: none">
            Explanation v
          </div>
          <div class="explanation" id="explanation_n" style="display: none">
            Explanation n
          </div>
          <div class="explanation" id="explanation_m" style="display: none">
            Explanation m
          </div>
          <div class="explanation" id="explanation_alpha" style="display: none">
            Explanation alpha
          </div>
          <div class="explanation" id="explanation_beta" style="display: none">
            Explanation beta
          </div>
          <div class="explanation" id="explanation_largeA" style="display: none">
            Explanation largeA
          </div>
          <div class="explanation" id="explanation_a" style="display: none">
            Explanation a
          </div>
          <div class="explanation" id="explanation_b" style="display: none">
            Explanation b
          </div>
          <div class="explanation" id="explanation_c" style="display: none">
            Explanation c
          </div>
          <div class="explanation" id="explanation_d" style="display: none">
            Explanation d
          </div>
          <div class="explanation" id="explanation_e" style="display: none">
            Explanation e
          </div>
          <div class="explanation" id="explanation_f" style="display: none">
            Explanation f
          </div>
          <div class="explanation" id="explanation_g" style="display: none">
            Explanation g
          </div>
          <div class="explanation" id="explanation_delta_z" style="display: none">
            Explanation delta z
          </div>
          <div class="explanation" id="explanation_gamma" style="display: none">
            Explanation gamma
          </div>
          <div class="explanation" id="explanation_Omega" style="display: none">
            Explanation Omega
          </div>
          <div class="explanation" id="explanation_delta" style="display: none">
            Explanation delta
          </div>
          <div class="explanation" id="explanation_hp" style="display: none">
            Explanation hp
          </div>
          <div class="explanation" id="explanation_atk" style="display: none">
            Explanation atk
          </div>
          <div class="explanation" id="explanation_def" style="display: none">
            Explanation def
          </div>
          <div class="explanation" id="explanation_attack_speed" style="display: none">
            Explanation attack_speed
          </div>
          <div class="explanation" id="explanation_critical" style="display: none">
            Explanation critical
          </div>
          <div class="explanation" id="explanation_criticalDamage" style="display: none">
            Explanation criticalDamage
          </div>
          <div class="explanation" id="explanation_super_critical" style="display: none">
            Explanation super_critical
          </div>
          <div class="explanation" id="explanation_super_critical_damage" style="display: none">
            Explanation super_critical_damage
          </div>
          <div class="explanation" id="explanation_rare_chance" style="display: none">
            Explanation rare_chance
          </div>
          <div class="explanation" id="explanation_math_skill" style="display: none">
            Explanation math_skill
          </div>
          <div class="explanation" id="explanation_enemy_growth_reduction" style="display: none">
            Explanation enemy_growth_reduction
          </div>
        </div>

        <div class="marked" style="position: absolute; left: 1200px; width: 300px">
          <div class="effect marked explainable explain_hp" style="height: 20px">
            <div>HP</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_hp">0</div>
          </div>
          <div class="effect marked explainable explain_atk" style="height: 20px">
            <div>ATK</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_atk">0</div>
          </div>
          <div class="effect marked explainable explain_def" style="height: 20px">
            <div>DEF</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_def">0</div>
          </div>
          <div class="effect marked explainable explain_attack_speed" style="height: 20px">
            <div>Attack Speed</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_attack_speed">0</div>
          </div>
          <div class="effect marked explainable explain_attack_speed" style="height: 20px">
            <div>- Pure Attack Speed</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display battle_reward_attackSpeed">0</div>
          </div>
          <div class="effect marked explainable explain_attack_speed" style="height: 20px">
            <div>- Time to Attack</div>
            <div>&nbsp;=&nbsp;</div>
            <div id="custom_update_time_to_attack">0</div>
            <script>
              idlespiral.addUpdateFunction(function() {
                $("#custom_update_time_to_attack").text(2/idlespiral.evaluate("attack_speed"));
              });
            </script>
          </div>
          <div class="effect marked explainable explain_critical" style="height: 20px">
            <div>Crit Rate</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_critical">0</div>
          </div>
          <div class="effect marked explainable explain_criticalDamage" style="height: 20px">
            <div>Crit Damage</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_criticalDamage">0</div>
          </div>
          <div class="effect marked explainable explain_super_critical" style="height: 20px">
            <div>S-Crit Rate</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_super_critical">0</div>
          </div>
          <div class="effect marked explainable explain_super_critical_damage" style="height: 20px">
            <div>S-Crit Damage</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_super_critical_damage">0</div>
          </div>
          <div class="effect marked explainable explain_rare_chance" style="height: 20px">
            <div>Rare Drop Rate</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_rare_drop">0</div>
          </div>
          <div class="effect marked explainable explain_rare_chance" style="height: 20px">
            <div>- Pure Rare Drop</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display battle_reward_rare_chance">0</div>
          </div>
          <div class="effect marked explainable explain_math_skill" style="height: 20px">
            <div>Math Skill</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_math_skill">0</div>
          </div>
          <div class="effect marked explainable explain_enemy_growth_reduction" style="height: 20px">
            <div>Enemy Growth Reduction</div>
            <div>&nbsp;=&nbsp;</div>
            <div class="update_display display_enemy_growth_reduction">0</div>
          </div>
        </div>

      </div>

      <section id="tab-c" class="tab hidden">
        <div>
          Changelog:
            v1.5.0:
              - Initial version to be tracked; might work backwards at some point
        </div>
      </section>
      <section id="tab-m" class="tab hidden">
        <div>
          Meta Changelog:
            v0.2206142003
              - Bare bones framework
            v0.2206150111
              - Added save decryption
            v0.2206150140
              - Added initial table dump
            v0.2206151154
              - Reconstructing UpgradeContainer
            v0.2206151238
              - Reconstructing BattleRewardContainer
            v0.2206151449
              - Added tab selection
            v0.2206151609
              - Loading r, p, and z tab upgrades
            v0.2206151649
              - Loading T tab info
            v0.2206151710
              - Loading B tab battle rewards
            v0.2206151904
              - Loading E tab info
            v0.2206152000
              - Loading C tab info
            v0.2206152045
              - Loading Z tab info
            v0.2206170010
              - Improved r tab layout
              - Added r tab formulas
            v0.2206170018
              - Improved p tab layout
              - Added p tab formulas
            v0.2206170028
              - Improved z tab layout
              - Added z tab formulas
            v0.2206170033
              - Added faq tab
            v0.2206170118
              - Improved E tab layout
              - Added E tab formulas
            v0.2206190113
              - Added D tab info
            v0.2206210109
              - Complete overhaul
            v0.2206220142
              - Small fixes and updating ui
            v0.2206231841
              - Linked B tab again and displaying diminished stats
            v0.2206261626
              - Many overhauls
        </div>
      </section>
    </body>
</html>
